我来详细分析这个项目。首先读取一些关键文件来了解项目背景。

[4 tools called]

现在让我探索各个主要目录的内容：

[8 tools called]

让我再看看一些关键目录的细节：

[4 tools called]

现在让我看看 robot 目录的内容，因为这是 modify.txt 中显示修改较多的部分：

[2 tools called]

好的，我已经详细分析了这个项目。让我为您提供一份全面的项目结构和功能说明：

# 📋 AC79 系列 WiFi&蓝牙 AIoT 固件项目分析

## 🎯 项目概述

这是**杰理科技（JieLi）AC79 系列芯片**的开源固件开发 SDK，是一个针对 WiFi/蓝牙双模 AIoT 设备的完整嵌入式开发环境。

**芯片特性**：

- 双核 DSP，最高 320MHz 主频
- 支持 WiFi 802.11b/g/n + 蓝牙 5.0 双模
- 内置 578KB SRAM，可扩展 SDRAM
- 集成音视频处理能力
- 应用场景：智能音箱、IP 摄像头、故事机、扫码枪、门铃等

---

## 📁 项目目录结构详解

### 1️⃣ **apps/** - 应用程序层

存放所有应用级代码和方案实现

#### **apps/common/** - 公共功能模块（核心）

```
├─ asr/              # 语音识别模块（aisp、jlkws、roobo、wanson等引擎）
├─ audio_music/      # 音频处理（播放、解码、音效处理）
├─ ble/              # 蓝牙低功耗（BLE配网、mesh、数据传输）
├─ camera/           # 摄像头驱动（支持20+种型号：GC0307/0308、OV7670等）
├─ network_protocols/ # 网络协议（WebSocket、JSON工具）
│  └─ websocket/    # ⭐ WebSocket实现（含Opus音频解码播放）
├─ robot/           # 🤖 机器人控制模块（电机、传感器、编程等）
├─ ui/              # UI框架和控件
├─ flash/           # Flash操作API
├─ net/             # WiFi配置和网络管理
├─ key/             # 按键驱动（ADC、IO、红外、触摸、矩阵键盘）
├─ iic/             # I2C总线驱动
├─ fm/              # FM收音模块（BK1080、QN8035、RDA5807）
├─ gsensor/         # 重力传感器（DA380、GMA301、MSA300、STK8312）
├─ usb/             # USB主从设备驱动
├─ update/          # 固件升级模块
└─ example/         # 丰富的示例代码
   ├─ audio/        # 音频示例
   ├─ bluetooth/    # 蓝牙示例
   ├─ wifi/         # WiFi示例
   ├─ video/        # 视频示例
   ├─ peripheral/   # 外设示例
   └─ network_protocols/ # 网络协议示例
```

#### **apps/demo/** - Demo 示例应用

```
├─ demo_hello/           # Hello World入门示例
├─ demo_wifi/            # WiFi基础功能
├─ demo_ble/             # 蓝牙功能
├─ demo_audio/           # 音频功能
├─ demo_video/           # 视频功能
├─ demo_ui/              # UI界面
├─ demo_DevKitBoard/     # 开发板完整测试
├─ demo_edr/             # 蓝牙EDR
├─ demo_uvc/             # USB摄像头
├─ demo_wifi_ext/        # WiFi扩展功能
└─ demo_matter/          # Matter智能家居协议
```

#### **apps/** 主要应用方案

```
├─ wifi_ipc/             # WiFi IP摄像头方案
├─ wifi_camera/          # WiFi摄像头（行车记录仪）
├─ wifi_story_machine/   # WiFi故事机/音箱
└─ scan_box/             # 扫码枪方案
```

---

### 2️⃣ **cpu/** - CPU 架构相关

```
cpu/wl82/
├─ liba/            # 预编译库文件（180+个.a静态库）
│  ├─ btctrler.a    # 蓝牙控制器
│  ├─ btstack.a     # 蓝牙协议栈
│  ├─ audio_server.a # 音频服务
│  ├─ video_rec_server.a # 视频录制
│  ├─ wl_wifi*.a    # WiFi驱动库
│  ├─ lwip*.a       # TCP/IP协议栈
│  ├─ libopus*.a    # Opus编解码
│  ├─ lib_mp3*.a    # MP3编解码
│  ├─ libdui.a      # 思必驰AI
│  ├─ libtencent.a  # 腾讯云
│  ├─ libturing.a   # 图灵机器人
│  └─ ... (音视频编解码、AI、云平台等)
├─ sdk.ld           # 链接脚本
├─ key/             # 按键驱动底层
└─ tools/           # CPU专用工具
```

---

### 3️⃣ **lib/** - 第三方库和网络协议

```
lib/
├─ net/
│  ├─ lwip_2_1_3/      # LwIP TCP/IP协议栈
│  ├─ mbedtls_*/       # TLS/SSL加密库（2.2.1和2.26.0版本）
│  ├─ curl-7.61.1/     # HTTP客户端
│  ├─ mqtt/            # MQTT协议
│  ├─ cJSON/           # JSON解析
│  ├─ http_server/     # HTTP服务器
│  ├─ websocket/       # WebSocket库
│  ├─ aliyun/          # 阿里云IoT
│  ├─ tencent/         # 腾讯云IoT
│  ├─ dui/             # 思必驰对话系统
│  ├─ turing/          # 图灵机器人
│  ├─ tmallgenie/      # 天猫精灵
│  ├─ EchoCloud/       # 智能音箱云平台
│  ├─ telecom/         # 中国电信智能家居
│  └─ libduer-device/  # 百度DuerOS
└─ server/             # 服务框架
```

---

### 4️⃣ **include_lib/** - 头文件库

```
include_lib/
├─ btctrler/        # 蓝牙控制器头文件
├─ btstack/         # 蓝牙协议栈头文件
├─ driver/          # 硬件驱动头文件
│  ├─ cpu/wl82/     # WL82芯片寄存器定义
│  └─ device/       # 外设接口定义
├─ media/           # 音视频处理头文件
│  ├─ audio_effect.h # 音效
│  ├─ eq/           # 均衡器
│  └─ drc/          # 动态范围压缩
├─ net/             # 网络协议头文件
├─ server/          # 服务器框架头文件
│  ├─ audio_server.h
│  ├─ video_server.h
│  └─ ai_server.h
├─ system/          # 系统核心头文件
│  ├─ os/           # 操作系统（FreeRTOS）
│  └─ task.h
└─ update/          # 升级接口
```

---

### 5️⃣ **tools/** - 编译工具链

```
tools/utils/
├─ make.exe         # GNU Make
├─ merge-archives.exe # 库文件合并工具
├─ override-seg.exe # 段覆盖工具
├─ rm.exe / ls.exe / mkdir_win.exe # Unix命令Windows版
└─ ... (编译辅助工具)
```

---

### 6️⃣ **doc/** - 开发文档

```
doc/
├─ datasheet/       # 芯片数据手册和选型表
│  └─ AC791N规格书/
│     ├─ datasheet/ # AC7911B/7912A/7913A/7915A/7916A等
│     └─ schematic/ # 参考原理图（音箱/IPC/故事机/飞控等）
└─ stuff/           # 开发资料
   ├─ AC79xx音频服务使用开发文档.pdf
   ├─ RF测试盒-使用说明.pdf
   ├─ Windows工具链安装使用说明.pdf
   └─ 蓝牙AT协议.pdf
```

---

### 7️⃣ **sdk_tools/** & **ui_project/** - 外部工具

需要从官方下载：

- **sdk_tools**: 固件烧录、调试、配置工具
- **ui_project**: UI 设计工具和资源

下载地址在对应 README.md 中

---

### 8️⃣ **根目录文件**

| 文件                  | 功能                                   |
| --------------------- | -------------------------------------- |
| **Makefile**          | 顶层构建文件（支持编译 17 种固件配置） |
| **default.workspace** | Code::Blocks 工作空间配置              |
| **README.md**         | 项目说明和快速开始指南                 |
| **LICENSE**           | Apache 2.0 开源协议                    |
| **modify.txt**        | Git 工作区修改记录                     |
| **info.json**         | MCP 协议配置（与 Cursor IDE 集成相关） |
| **.gitignore**        | Git 忽略规则                           |

---

## 🔥 核心功能模块

### 🎵 音频处理

- **编码**：SBC/AAC/MP3/OPUS/AMR/ADPCM
- **解码**：MP3/AAC/WAV/FLAC/WMA/APE/DTS
- **音效**：混响/回声/变声/变速/EQ/DRC/降噪
- **AI**：VAD/唤醒/识别

### 📹 视频处理

- **编码**：JPEG 720P@30fps
- **接口**：DVP/SPI 摄像头
- **显示**：RGB/SPI/EMI 推屏

### 🌐 网络功能

- **WiFi**：AP/STA 模式、配网、快连
- **协议**：HTTP/HTTPS/MQTT/WebSocket/CoAP/FTP
- **云平台**：阿里云/腾讯云/百度云/天猫精灵/涂鸦

### 📡 蓝牙功能

- **规范**：蓝牙 5.0 + BR/EDR + BLE
- **Profile**：A2DP/HFP/SPP/HID/GATT
- **Mesh**：蓝牙 Mesh 网络

### 🤖 机器人控制（重点修改区域）

根据 `modify.txt`，这个模块最近有大量修改：

```
robot_2p4g      # 2.4G无线通信
robot_action    # 动作控制
robot_ai        # AI功能
robot_motor     # 电机驱动
robot_sensor    # 传感器接口
robot_program   # 编程功能
robot_light     # 灯光控制
robot_sound     # 声音播放
```

### 🎤 WebSocket 音频流（最新功能）

位于 `apps/common/network_protocols/websocket/`：

- WebSocket 接收音频流
- Opus 实时解码
- PCM 播放输出
- 支持 TTS 控制消息

---

## 🛠️ 支持的编译目标

根据 `Makefile`，支持以下固件方案：

| 目标                      | 芯片   | 应用场景              |
| ------------------------- | ------ | --------------------- |
| ac791n_wifi_ipc           | AC791N | WiFi IP 摄像头        |
| ac791n_wifi_camera        | AC791N | WiFi 行车记录仪       |
| ac791n_wifi_story_machine | AC791N | WiFi 故事机/音箱      |
| ac790n_wifi_story_machine | AC790N | WiFi 故事机（AC790N） |
| ac791n_scan_box           | AC791N | 扫码枪                |
| ac791n*demo*\*            | AC791N | 各类 Demo 示例        |

编译命令：

```bash
make ac791n_wifi_ipc
make ac791n_wifi_story_machine
make clean
```

---

## 🔧 开发环境

- **编译器**：定制的 Clang（位于 `/opt/jieli/common/bin/clang`）
- **IDE**：Code::Blocks（workspace 已配置）
- **OS**：支持 Linux 和 Windows
- **调试**：串口调试、在线调试

---

## 📊 项目规模统计

- **总代码量**：约 100 万行+（含第三方库）
- **静态库数量**：180+个预编译库
- **摄像头驱动**：20+种型号
- **示例代码**：100+个 example
- **应用方案**：4 个完整方案 + 11 个 Demo

---

## 🆕 最新修改（根据 modify.txt）

最近的开发重点在：

1. **机器人控制模块**（58 个文件修改）
2. **WebSocket 音频流**（新增 Opus 解码播放）
3. **BLE 配网**（腾讯云、图灵等）
4. **第三方库集成**（AWTK UI 库、LittleFS 文件系统）

---

## 📖 推荐学习路径

1. **入门**：从 `apps/demo/demo_hello/` 开始
2. **音频**：看 `apps/demo/demo_audio/` 和 `apps/common/audio_music/`
3. **WiFi**：看 `apps/demo/demo_wifi/` 和 `apps/common/net/`
4. **完整方案**：参考 `apps/wifi_story_machine/`
5. **API 文档**：查看 [官方文档](https://doc.zh-jieli.com/AC79/)

---

这是一个**非常专业和完整的嵌入式 AIoT 开发平台**，特别适合开发智能音箱、摄像头、教育机器人等 WiFi/蓝牙物联网设备。代码组织清晰，模块化程度高，提供了大量可复用的驱动和中间件。

需要我深入分析某个特定模块吗？
